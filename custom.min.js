const _0x5f5487=_0x4715;(function(_0x4efcc8,_0x3ec8e3){const _0x61b906=_0x4715,_0x11dfbb=_0x4efcc8();while(!![]){try{const _0x20692c=parseInt(_0x61b906(0xce))/0x1*(-parseInt(_0x61b906(0x115))/0x2)+parseInt(_0x61b906(0xd2))/0x3*(parseInt(_0x61b906(0x119))/0x4)+-parseInt(_0x61b906(0x102))/0x5+parseInt(_0x61b906(0xd3))/0x6+parseInt(_0x61b906(0x10a))/0x7+-parseInt(_0x61b906(0xf3))/0x8*(parseInt(_0x61b906(0xe6))/0x9)+-parseInt(_0x61b906(0xcb))/0xa;if(_0x20692c===_0x3ec8e3)break;else _0x11dfbb['push'](_0x11dfbb['shift']());}catch(_0x35cfe9){_0x11dfbb['push'](_0x11dfbb['shift']());}}}(_0x414c,0x74b43));function _0x4715(_0x360f17,_0xafaf77){const _0x414c91=_0x414c();return _0x4715=function(_0x4715bf,_0x5dcf3f){_0x4715bf=_0x4715bf-0xc3;let _0x1aa61c=_0x414c91[_0x4715bf];return _0x1aa61c;},_0x4715(_0x360f17,_0xafaf77);}const genobank=new GenoBankLogin();genobank[_0x5f5487(0x10d)]();let prevButtons={};function startLoadingButton(_0xb658b0){const _0x31054a=_0x5f5487;$('#'+_0xb658b0)[_0x31054a(0x111)](_0x31054a(0xd4),!0x0),prevButtons[_0xb658b0]={'prevContent':$('#'+_0xb658b0)['html']()},$('#'+_0xb658b0)['html']('\x20\x0a\x09\x09<span\x20class=\x22spinner-grow\x20spinner-grow-sm\x22\x20aria-hidden=\x22true\x22></span>\x0a\x09\x09<span\x20role=\x22status\x22\x20class=\x22h6\x22\x20>Loading...</span>\x0a\x20\x20\x09');}function stopLoadingButton(_0x13be0c){const _0x52e6e9=_0x5f5487;$('#'+_0x13be0c)[_0x52e6e9(0x111)]('disabled',!0x1),$('#'+_0x13be0c)[_0x52e6e9(0xe0)](prevButtons[_0x13be0c]?.[_0x52e6e9(0xca)]);}function _0x414c(){const _0x32c579=['disabled','rpcProvider','magic_email','idToken','metamask','then','MESSAGE_TO_SIGN','https://genobank.io/','#id-oauth-loading-text','getValidatePermittee','443','location','html','eth','auth','setItem','show','jwt','140445hkLaci','port','catch','userInfo','sign','data','eth_requestAccounts','Finishing...','pathname','#emailInput','Error\x20signing\x20the\x20message:','user','source','248uutfFZ','MetaMask\x20is\x20not\x20detected.\x20Please\x20install\x20MetaMask\x20and\x20try\x20again.','magic','oauth','publicAddress','loginWithMagicLink','?data=','id-metamask-button','protocol','search','hostname','request','Web3Provider','getSigner','replace','2056800hquTJI','Getting\x20user\x20data...','hide','.toast','error','Generating\x20signature...','providers','Error:\x20','5684448mvVXqK','id-google-button','stringify','init','Error:','application/json','log','attr','#metamaskLoginSpiner','close','message','25790FDFzrq','CHAIN_ID','loginWithRedirect','/oauth-callback.html','4404XitnBc','val','finishingLoginProcess','opener','No\x20account\x20found\x20in\x20localStorage.','ethereum','userMetadata','DOMContentLoaded','prevContent','396660yiZRKD','isLoggedIn','postMessage','47BFivKr','text','id-email-button','href','2253KqYiPY','2279700uhLemI'];_0x414c=function(){return _0x32c579;};return _0x414c();}function showErrorToast(_0x13af45){const _0x2d8a5b=_0x5f5487;$('.toast\x20.toast-body')[_0x2d8a5b(0xcf)](_0x13af45);let _0xbe908d=$(_0x2d8a5b(0x105));new bootstrap['Toast'](_0xbe908d)[_0x2d8a5b(0xe4)]();}function magicConstructor(){const _0x5a7588=_0x5f5487;return new Magic(window['MAGIC_API_KEY'],{'extensions':[new MagicOAuthExtension()],'network':{'rpcUrl':window['RPC_NETWORK'],'chainId':window[_0x5a7588(0x116)]}});}async function loginUsingMetamask(){const _0x4e29cf=_0x5f5487;startLoadingButton(_0x4e29cf(0xfa));try{const _0x349c50=$(_0x4e29cf(0x112));if(void 0x0===window[_0x4e29cf(0xc7)])return showErrorToast(_0x4e29cf(0xf4)),void _0x349c50[_0x4e29cf(0x104)]();let _0x4c58c2=new ethers[(_0x4e29cf(0x108))][(_0x4e29cf(0xff))](window[_0x4e29cf(0xc7)]);const _0x207748=await metamaskLogin(_0x4c58c2,window[_0x4e29cf(0xda)]);await finishingLoginProcess(_0x207748);}catch(_0x4c7f4){stopLoadingButton('id-metamask-button'),showErrorToast(_0x4e29cf(0x109)+_0x4c7f4['message']);}}async function metamaskLogin(_0x54da02,_0x384d92){const _0x31c251=_0x5f5487;await window['ethereum'][_0x31c251(0xfe)]({'method':_0x31c251(0xec)});let _0x58f401=await _0x54da02[_0x31c251(0x100)]()['signMessage'](_0x384d92),_0x284889=await _0x54da02['getSigner']()['getAddress']();return{'userSignature':_0x58f401,'userWallet':_0x284889,'isPermittee':!!await genobank[_0x31c251(0xdd)](_0x284889),'loginMethod':_0x31c251(0xd8)};}async function loginUsingGoogle(){const _0x16f8d=_0x5f5487;startLoadingButton(_0x16f8d(0x10b));try{let _0x560821=magicConstructor();await _0x560821[_0x16f8d(0xf6)][_0x16f8d(0x117)]({'provider':'google','redirectURI':window[_0x16f8d(0xdf)][_0x16f8d(0xfb)]+'//'+getCurrentDomainWithPort()+_0x16f8d(0x118)});}catch(_0x2e9f7e){stopLoadingButton(_0x16f8d(0x10b)),showErrorToast('Error:\x20'+_0x2e9f7e[_0x16f8d(0x114)]);}}async function handleOAuthResult(){const _0x3fa959=_0x5f5487;try{let _0x499089=magicConstructor();$(_0x3fa959(0xdc))[_0x3fa959(0xe0)](_0x3fa959(0x103));const _0x1839f7=await _0x499089[_0x3fa959(0xf6)]['getRedirectResult']();let _0x376298=await genobank[_0x3fa959(0xdd)](_0x1839f7?.[_0x3fa959(0xf5)]?.[_0x3fa959(0xc8)]?.[_0x3fa959(0xf7)]);$(_0x3fa959(0xdc))[_0x3fa959(0xe0)](_0x3fa959(0x107));const _0x2e6c06={'userSignature':await signAndVerify(MESSAGE_TO_SIGN,_0x1839f7?.[_0x3fa959(0xf5)]?.[_0x3fa959(0xc8)]?.[_0x3fa959(0xf7)]),'userWallet':_0x1839f7?.['magic']?.[_0x3fa959(0xc8)]?.[_0x3fa959(0xf7)],'isPermittee':_0x376298,'loginMethod':_0x3fa959(0xf5),'magicToken':_0x1839f7?.[_0x3fa959(0xf5)]?.[_0x3fa959(0xd7)],'email':_0x1839f7?.['oauth']?.['userInfo']?.['email'],'name':_0x1839f7?.[_0x3fa959(0xf6)]?.[_0x3fa959(0xe9)]?.['name'],'picture':_0x1839f7?.[_0x3fa959(0xf6)]?.[_0x3fa959(0xe9)]?.['picture']};$(_0x3fa959(0xdc))['html'](_0x3fa959(0xed)),await finishingLoginProcess(_0x2e6c06);}catch(_0xaac41d){console[_0x3fa959(0x106)](_0xaac41d);}}async function loginUsingEmailHandler(){const _0x168069=_0x5f5487;startLoadingButton(_0x168069(0xd0));try{const _0x5751be=$(_0x168069(0xef))[_0x168069(0xc3)]();await loginUsingEmail(_0x5751be);}catch(_0x58be8b){console[_0x168069(0x106)]('Error\x20in\x20loginUsingEmailHandler:',_0x58be8b),showErrorToast(_0x168069(0x109)+_0x58be8b[_0x168069(0x114)]);}finally{stopLoadingButton(_0x168069(0xd0));}}async function loginUsingEmail(_0x3ca5ce){const _0x3eb747=_0x5f5487;try{const _0x522d79=magicConstructor(),_0x16db40=await _0x522d79[_0x3eb747(0xe2)][_0x3eb747(0xf8)]({'email':_0x3ca5ce}),_0xf05ee1=await _0x522d79[_0x3eb747(0xf1)]['getInfo']();let _0x1a5aeb=await genobank['getValidatePermittee'](_0x16db40?.[_0x3eb747(0xf5)]?.[_0x3eb747(0xc8)]?.[_0x3eb747(0xf7)]);const _0x379787={'userSignature':await signAndVerify(window[_0x3eb747(0xda)],_0xf05ee1?.[_0x3eb747(0xf7)]),'userWallet':_0xf05ee1?.[_0x3eb747(0xf7)],'isPermittee':!!_0x1a5aeb,'loginMethod':_0x3eb747(0xd6),'magicToken':_0x16db40,'email':_0xf05ee1?.['email']};await finishingLoginProcess(_0x379787);}catch(_0x50d750){console[_0x3eb747(0x106)](_0x50d750);}}async function signAndVerify(_0x39e70a,_0x414ca4){const _0x46b0f3=_0x5f5487;try{if(!_0x414ca4)throw new Error(_0x46b0f3(0xc6));const _0xc0262b=magicConstructor(),_0x5af067=new Web3(_0xc0262b[_0x46b0f3(0xd5)]);if(!await _0xc0262b[_0x46b0f3(0xf1)][_0x46b0f3(0xcc)]())throw new Error('User\x20is\x20not\x20logged\x20in\x20with\x20Magic.');return await _0x5af067[_0x46b0f3(0xe1)]['personal'][_0x46b0f3(0xea)](_0x39e70a,_0x414ca4,'');}catch(_0x27baf6){console[_0x46b0f3(0x106)](_0x46b0f3(0xf0),_0x27baf6);}}async function finishingLoginProcess(_0x55a055){const _0x2bd43c=_0x5f5487,_0x17e00e=getConfig();if(console[_0x2bd43c(0x110)](_0x17e00e),_0x17e00e['isPopup'])sendToParent(_0x17e00e?.[_0x2bd43c(0xf2)],_0x55a055);else{const _0x388a08=await generateAuthJWT(_0x55a055);window[_0x2bd43c(0xdf)]['href']=_0x17e00e?.['source']+_0x2bd43c(0xf9)+btoa(_0x388a08?.[_0x2bd43c(0xe5)]);}}function sendToParent(_0x3a00a1,_0x3ed582){const _0x265939=_0x5f5487,_0x5588ac={'genobankLogin':_0x3ed582};window[_0x265939(0xc5)][_0x265939(0xcd)](_0x5588ac,_0x3a00a1),window[_0x265939(0x113)]();}async function generateAuthJWT(_0x4767dc){const _0x5e8fca=_0x5f5487,_0x4f576e=new URL('https://genobank.app/generate_jwt');return fetch(_0x4f576e,{'method':'POST','headers':{'Content-Type':_0x5e8fca(0x10f)},'body':JSON[_0x5e8fca(0x10c)](_0x4767dc)})[_0x5e8fca(0xd9)](_0x3879ed=>_0x3879ed['json']())[_0x5e8fca(0xe8)](_0x4dd832=>console['error'](_0x5e8fca(0x10e),_0x4dd832));}function getCurrentDomainWithPort(){const _0x3e43b5=_0x5f5487,_0x486968=window[_0x3e43b5(0xdf)];let _0x2cac22=_0x486968[_0x3e43b5(0xfd)];return _0x486968['port']&&'80'!==_0x486968[_0x3e43b5(0xe7)]&&_0x3e43b5(0xde)!==_0x486968[_0x3e43b5(0xe7)]&&(_0x2cac22+=':'+_0x486968[_0x3e43b5(0xe7)]),_0x2cac22;}function saveConfig(_0x295938){const _0x5d479e=_0x5f5487;sessionStorage[_0x5d479e(0xe3)](_0x5d479e(0xeb),_0x295938);}function getConfig(_0x5e35d1=!0x1){const _0x377a9a=_0x5f5487;decoded=atob(sessionStorage['getItem'](_0x377a9a(0xeb)))[_0x377a9a(0x101)](/'/g,'\x22');const _0x16354e=JSON['parse'](decoded);return 0x0!=_0x5e35d1?_0x16354e[_0x5e35d1]:_0x16354e;}!(function(){const _0x46c3be=_0x5f5487;try{const _0x586e7a=new URLSearchParams(window[_0x46c3be(0xdf)][_0x46c3be(0xfc)])['get'](_0x46c3be(0xeb));if(!_0x586e7a)return void(window[_0x46c3be(0xdf)][_0x46c3be(0xd1)]=_0x46c3be(0xdb));saveConfig(_0x586e7a);}catch(_0x3f1d2c){}}()),document['addEventListener'](_0x5f5487(0xc9),function(){const _0x350c54=_0x5f5487;_0x350c54(0x118)===window[_0x350c54(0xdf)][_0x350c54(0xee)]&&handleOAuthResult();}),window[_0x5f5487(0xc4)]=finishingLoginProcess;