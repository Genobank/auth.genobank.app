const _0x1a7da1=_0x46d3;function _0x46d3(_0x455d9d,_0x321afe){const _0x2fda04=_0x2fda();return _0x46d3=function(_0x46d3c4,_0x1ccc9b){_0x46d3c4=_0x46d3c4-0x121;let _0x49fe6e=_0x2fda04[_0x46d3c4];return _0x49fe6e;},_0x46d3(_0x455d9d,_0x321afe);}(function(_0x46570d,_0x449fa3){const _0x44f957=_0x46d3,_0x47e9e4=_0x46570d();while(!![]){try{const _0x3798a5=parseInt(_0x44f957(0x149))/0x1+-parseInt(_0x44f957(0x122))/0x2+-parseInt(_0x44f957(0x132))/0x3+-parseInt(_0x44f957(0x153))/0x4+parseInt(_0x44f957(0x161))/0x5*(-parseInt(_0x44f957(0x14f))/0x6)+-parseInt(_0x44f957(0x15d))/0x7+parseInt(_0x44f957(0x16a))/0x8*(parseInt(_0x44f957(0x16c))/0x9);if(_0x3798a5===_0x449fa3)break;else _0x47e9e4['push'](_0x47e9e4['shift']());}catch(_0x3ab9a9){_0x47e9e4['push'](_0x47e9e4['shift']());}}}(_0x2fda,0x6960c));const genobank=new GenoBankLogin();genobank['init']();let prevButtons={};function startLoadingButton(_0x4a149f){const _0x265e29=_0x46d3;$('#'+_0x4a149f)['attr']('disabled',!0x0),prevButtons[_0x4a149f]={'prevContent':$('#'+_0x4a149f)['html']()},$('#'+_0x4a149f)['html'](_0x265e29(0x121));}function stopLoadingButton(_0x421c3d){const _0x29fa89=_0x46d3;$('#'+_0x421c3d)[_0x29fa89(0x12f)]('disabled',!0x1),$('#'+_0x421c3d)[_0x29fa89(0x123)](prevButtons[_0x421c3d]?.[_0x29fa89(0x172)]);}function showErrorToast(_0x2f3e4f){const _0x11a10c=_0x46d3;$(_0x11a10c(0x179))[_0x11a10c(0x145)](_0x2f3e4f);let _0x22e9b9=$('.toast');new bootstrap[(_0x11a10c(0x171))](_0x22e9b9)['show']();}function magicConstructor(){const _0x45fbd8=_0x46d3;return new Magic(window[_0x45fbd8(0x17b)],{'extensions':[new MagicOAuthExtension()],'network':{'rpcUrl':window[_0x45fbd8(0x169)],'chainId':window[_0x45fbd8(0x141)]}});}async function loginUsingMetamask(){const _0x298f84=_0x46d3;startLoadingButton(_0x298f84(0x176));try{const _0x2c80f4=$(_0x298f84(0x17c));if(void 0x0===window[_0x298f84(0x13f)])return showErrorToast('MetaMask\x20is\x20not\x20detected.\x20Please\x20install\x20MetaMask\x20and\x20try\x20again.'),void _0x2c80f4[_0x298f84(0x16b)]();let _0x4f2a45=new ethers[(_0x298f84(0x16f))][(_0x298f84(0x140))](window['ethereum']);const _0x4dff93=await metamaskLogin(_0x4f2a45,window[_0x298f84(0x13c)]);await finishingLoginProcess(_0x4dff93);}catch(_0x2f5944){stopLoadingButton(_0x298f84(0x176)),showErrorToast(_0x298f84(0x135)+_0x2f5944[_0x298f84(0x15c)]);}}async function metamaskLogin(_0x46de76,_0x1fd5a0){const _0x40f332=_0x46d3;await window[_0x40f332(0x13f)][_0x40f332(0x178)]({'method':_0x40f332(0x15f)});let _0x4d0abc=await _0x46de76[_0x40f332(0x166)]()[_0x40f332(0x138)](_0x1fd5a0),_0x318cd1=await _0x46de76[_0x40f332(0x166)]()[_0x40f332(0x15a)]();return{'userSignature':_0x4d0abc,'userWallet':_0x318cd1,'isPermittee':!!await genobank[_0x40f332(0x16e)](_0x318cd1),'loginMethod':_0x40f332(0x17a)};}async function loginUsingGoogle(){const _0x2954a2=_0x46d3;startLoadingButton(_0x2954a2(0x17f));try{let _0x2e72ff=magicConstructor();await _0x2e72ff[_0x2954a2(0x13e)][_0x2954a2(0x12b)]({'provider':_0x2954a2(0x125),'redirectURI':window[_0x2954a2(0x137)][_0x2954a2(0x156)]+'//'+getCurrentDomainWithPort()+'/oauth-callback.html'});}catch(_0x2e3726){stopLoadingButton(_0x2954a2(0x17f)),showErrorToast(_0x2954a2(0x135)+_0x2e3726[_0x2954a2(0x15c)]);}}async function handleOAuthResult(){const _0x203396=_0x46d3;try{let _0x1c938c=magicConstructor();$(_0x203396(0x14c))[_0x203396(0x123)]('Getting\x20user\x20data...');const _0x4c8336=await _0x1c938c[_0x203396(0x13e)][_0x203396(0x142)]();let _0x41d698=await genobank[_0x203396(0x16e)](_0x4c8336?.[_0x203396(0x148)]?.[_0x203396(0x170)]?.['publicAddress']);$(_0x203396(0x14c))[_0x203396(0x123)](_0x203396(0x143));const _0x589df9={'userSignature':await signAndVerify(MESSAGE_TO_SIGN,_0x4c8336?.[_0x203396(0x148)]?.[_0x203396(0x170)]?.[_0x203396(0x129)]),'userWallet':_0x4c8336?.[_0x203396(0x148)]?.[_0x203396(0x170)]?.[_0x203396(0x129)],'isPermittee':_0x41d698,'loginMethod':'magic','magicToken':_0x4c8336?.[_0x203396(0x148)]?.[_0x203396(0x150)],'email':_0x4c8336?.['oauth']?.['userInfo']?.[_0x203396(0x131)],'name':_0x4c8336?.['oauth']?.[_0x203396(0x175)]?.[_0x203396(0x130)],'picture':_0x4c8336?.['oauth']?.[_0x203396(0x175)]?.[_0x203396(0x17d)]};$('#id-oauth-loading-text')[_0x203396(0x123)](_0x203396(0x124)),await finishingLoginProcess(_0x589df9);}catch(_0x305b1a){console['error'](_0x305b1a);}}async function loginUsingEmailHandler(){const _0x4dbb87=_0x46d3;startLoadingButton(_0x4dbb87(0x167));try{const _0x13b568=$(_0x4dbb87(0x12c))['val']();await loginUsingEmail(_0x13b568);}catch(_0x29c040){console['error'](_0x4dbb87(0x126),_0x29c040),showErrorToast(_0x4dbb87(0x135)+_0x29c040[_0x4dbb87(0x15c)]);}finally{stopLoadingButton(_0x4dbb87(0x167));}}async function loginUsingEmail(_0xff8a57){const _0x4e33da=_0x46d3;try{const _0x281693=magicConstructor(),_0x4be18f=await _0x281693[_0x4e33da(0x14a)][_0x4e33da(0x12a)]({'email':_0xff8a57}),_0x25580b=await _0x281693[_0x4e33da(0x128)]['getInfo']();let _0x4d04c6=await genobank[_0x4e33da(0x16e)](_0x4be18f?.[_0x4e33da(0x148)]?.[_0x4e33da(0x170)]?.['publicAddress']);const _0x109d3a={'userSignature':await signAndVerify(window[_0x4e33da(0x13c)],_0x25580b?.[_0x4e33da(0x129)]),'userWallet':_0x25580b?.[_0x4e33da(0x129)],'isPermittee':!!_0x4d04c6,'loginMethod':_0x4e33da(0x151),'magicToken':_0x4be18f,'email':_0x25580b?.['email']};await finishingLoginProcess(_0x109d3a);}catch(_0x42f37e){console[_0x4e33da(0x136)](_0x42f37e);}}async function signAndVerify(_0x330b6d,_0x55c094){const _0x29f828=_0x46d3;try{if(!_0x55c094)throw new Error(_0x29f828(0x133));const _0x3a9082=magicConstructor(),_0x4c4666=new Web3(_0x3a9082[_0x29f828(0x17e)]);if(!await _0x3a9082[_0x29f828(0x128)][_0x29f828(0x160)]())throw new Error(_0x29f828(0x144));return await _0x4c4666[_0x29f828(0x13d)][_0x29f828(0x12d)][_0x29f828(0x159)](_0x330b6d,_0x55c094,'');}catch(_0x2bfe84){console[_0x29f828(0x136)](_0x29f828(0x12e),_0x2bfe84);}}function _0x2fda(){const _0x4ce8bc=['prevContent','href','jwt','userInfo','id-metamask-button','port','request','.toast\x20.toast-body','metamask','MAGIC_API_KEY','#metamaskLoginSpiner','picture','rpcProvider','id-google-button','stringify','\x20\x0a\x09\x09<span\x20class=\x22spinner-grow\x20spinner-grow-sm\x22\x20aria-hidden=\x22true\x22></span>\x0a\x09\x09<span\x20role=\x22status\x22\x20class=\x22h6\x22\x20>Loading...</span>\x0a\x20\x20\x09','260406XvWnYF','html','Finishing...','google','Error\x20in\x20loginUsingEmailHandler:','search','user','publicAddress','loginWithMagicLink','loginWithRedirect','#emailInput','personal','Error\x20signing\x20the\x20message:','attr','name','email','2376222yJmXzw','No\x20account\x20found\x20in\x20localStorage.','hostname','Error:\x20','error','location','signMessage','setItem','?data=','then','MESSAGE_TO_SIGN','eth','oauth','ethereum','Web3Provider','CHAIN_ID','getRedirectResult','Generating\x20signature...','User\x20is\x20not\x20logged\x20in\x20with\x20Magic.','text','getItem','443','magic','765964DMukcY','auth','catch','#id-oauth-loading-text','POST','application/json','4722414FLFRxG','idToken','magic_email','close','3122528qAsiTO','postMessage','https://genobank.io/','protocol','parse','get','sign','getAddress','source','message','1985151ootDlf','finishingLoginProcess','eth_requestAccounts','isLoggedIn','5YzGsxd','pathname','addEventListener','http://localhost:8081/generate_jwt','json','getSigner','id-email-button','opener','RPC_NETWORK','40rjnptn','hide','4390623LqJwhj','data','getValidatePermittee','providers','userMetadata','Toast'];_0x2fda=function(){return _0x4ce8bc;};return _0x2fda();}async function finishingLoginProcess(_0x4e3c32){const _0x1df60b=_0x46d3,_0x25850b=getConfig();if(console['log'](_0x25850b),_0x25850b['isPopup'])sendToParent(_0x25850b?.[_0x1df60b(0x15b)],_0x4e3c32);else{const _0x3309d3=await generateAuthJWT(_0x4e3c32);window[_0x1df60b(0x137)]['href']=_0x25850b?.[_0x1df60b(0x15b)]+_0x1df60b(0x13a)+btoa(_0x3309d3?.[_0x1df60b(0x174)]);}}function sendToParent(_0x6af92e,_0x307f3b){const _0x25e413=_0x46d3,_0x5890fa={'genobankLogin':_0x307f3b};window[_0x25e413(0x168)][_0x25e413(0x154)](_0x5890fa,_0x6af92e),window[_0x25e413(0x152)]();}async function generateAuthJWT(_0x5d615c){const _0x5446ee=_0x46d3,_0x36968f=new URL(_0x5446ee(0x164));return fetch(_0x36968f,{'method':_0x5446ee(0x14d),'headers':{'Content-Type':_0x5446ee(0x14e)},'body':JSON[_0x5446ee(0x180)](_0x5d615c)})[_0x5446ee(0x13b)](_0x31f330=>_0x31f330[_0x5446ee(0x165)]())[_0x5446ee(0x14b)](_0x5cc390=>console[_0x5446ee(0x136)]('Error:',_0x5cc390));}function getCurrentDomainWithPort(){const _0x3fd071=_0x46d3,_0x2bcc23=window['location'];let _0x548d7d=_0x2bcc23[_0x3fd071(0x134)];return _0x2bcc23[_0x3fd071(0x177)]&&'80'!==_0x2bcc23['port']&&_0x3fd071(0x147)!==_0x2bcc23[_0x3fd071(0x177)]&&(_0x548d7d+=':'+_0x2bcc23['port']),_0x548d7d;}function saveConfig(_0x4b5f1f){const _0xbb8ede=_0x46d3;sessionStorage[_0xbb8ede(0x139)](_0xbb8ede(0x16d),_0x4b5f1f);}function getConfig(_0x220905=!0x1){const _0x3e10e7=_0x46d3;decoded=atob(sessionStorage[_0x3e10e7(0x146)](_0x3e10e7(0x16d)))['replace'](/'/g,'\x22');const _0x254dc9=JSON[_0x3e10e7(0x157)](decoded);return 0x0!=_0x220905?_0x254dc9[_0x220905]:_0x254dc9;}!(function(){const _0x1ba420=_0x46d3;try{const _0x356d20=new URLSearchParams(window[_0x1ba420(0x137)][_0x1ba420(0x127)])[_0x1ba420(0x158)](_0x1ba420(0x16d));if(!_0x356d20)return void(window[_0x1ba420(0x137)][_0x1ba420(0x173)]=_0x1ba420(0x155));saveConfig(_0x356d20);}catch(_0xec86b6){}}()),document[_0x1a7da1(0x163)]('DOMContentLoaded',function(){const _0x37b905=_0x1a7da1;'/oauth-callback.html'===window['location'][_0x37b905(0x162)]&&handleOAuthResult();}),window[_0x1a7da1(0x15e)]=finishingLoginProcess;